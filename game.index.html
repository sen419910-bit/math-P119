<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Chomp</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #eff6ff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            touch-action: none;
        }
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            cursor: none;
        }
        canvas {
            display: block;
        }
        .ui-layer {
            position: absolute;
            top: 20px;
            left: 20px;
            pointer-events: none;
            color: #1e3a8a;
            font-size: 1.5rem;
            font-weight: bold;
            text-shadow: 1px 1px 0px white;
        }
        #overlay {
            position: absolute;
            inset: 0;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
            text-align: center;
            padding: 20px;
        }
        .btn {
            background: #2563eb;
            color: white;
            padding: 12px 32px;
            border-radius: 9999px;
            font-size: 1.25rem;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
            border: none;
            pointer-events: auto;
        }
        .btn:hover {
            transform: scale(1.05);
            background: #1d4ed8;
        }
        .target-box {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 12px;
            border: 3px solid #2563eb;
            text-align: center;
        }
    </style>
</head>
<body>

<div id="game-container">
    <div id="overlay">
        <h1 class="text-6xl font-black text-blue-600 mb-4">CALENDAR CHOMP</h1>
        <p class="text-xl text-gray-700 max-w-md">Eat the months in the correct order!</p>
        <p class="text-lg font-bold text-blue-500 mt-2">January â†’ February â†’ March...</p>
        <button class="btn" onclick="startGame()">START LEARNING</button>
    </div>

    <div class="ui-layer">
        <div>Score: <span id="score">0</span></div>
        <div class="text-sm mt-1">Teeth: <span id="health">ðŸ¦·ðŸ¦·ðŸ¦·</span></div>
    </div>

    <div class="target-box">
        <div class="text-gray-500 text-xs uppercase tracking-widest font-bold">Look for:</div>
        <div id="target-month" class="text-3xl font-black text-blue-600">JANUARY</div>
    </div>

    <canvas id="gameCanvas"></canvas>
</div>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    const scoreElement = document.getElementById('score');
    const healthElement = document.getElementById('health');
    const targetElement = document.getElementById('target-month');
    const overlay = document.getElementById('overlay');

    const MONTHS = [
        "JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", 
        "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"
    ];

    let score = 0;
    let health = 3;
    let currentMonthIndex = 0;
    let gameActive = false;
    let items = [];
    let particles = [];
    let mouth = { x: 0, y: 0, size: 70, targetX: 0, targetY: 0, open: 0 };

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    const updateTargetPos = (e) => {
        const x = e.touches ? e.touches[0].clientX : e.clientX;
        const y = e.touches ? e.touches[0].clientY : e.clientY;
        mouth.targetX = x;
        mouth.targetY = y;
    };
    window.addEventListener('mousemove', updateTargetPos);
    window.addEventListener('touchmove', updateTargetPos);

    class MonthItem {
        constructor() {
            this.reset();
            this.y = Math.random() * -canvas.height; 
        }

        reset() {
            // Pick a random month, but weight it slightly toward the target month
            if (Math.random() > 0.7) {
                this.monthName = MONTHS[currentMonthIndex];
            } else {
                this.monthName = MONTHS[Math.floor(Math.random() * MONTHS.length)];
            }
            
            this.x = Math.random() * (canvas.width - 150) + 75;
            this.y = -50;
            this.speed = 2 + Math.random() * 2 + (score / 200);
            this.color = `hsl(${Math.random() * 360}, 70%, 60%)`;
        }

        update() {
            this.y += this.speed;

            const dx = this.x - mouth.x;
            const dy = this.y - mouth.y;
            const distance = Math.sqrt(dx*dx + dy*dy);

            if (distance < mouth.size) {
                this.collect();
            }

            if (this.y > canvas.height + 50) {
                this.reset();
            }
        }

        collect() {
            if (this.monthName === MONTHS[currentMonthIndex]) {
                // Correct!
                score += 50;
                currentMonthIndex = (currentMonthIndex + 1) % 12;
                createParticles(this.x, this.y, '#4ade80', 15);
                updateUI();
            } else {
                // Wrong month!
                health--;
                createParticles(this.x, this.y, '#f87171', 20);
                shakeScreen();
                updateUI();
                if (health <= 0) endGame();
            }
            this.reset();
        }

        draw() {
            ctx.save();
            ctx.translate(this.x, this.y);
            
            // Bubble background
            ctx.shadowBlur = 10;
            ctx.shadowColor = 'rgba(0,0,0,0.1)';
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.roundRect(-60, -20, 120, 40, 10);
            ctx.fill();

            // Text
            ctx.fillStyle = this.color;
            ctx.font = 'bold 16px sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(this.monthName, 0, 0);
            ctx.restore();
        }
    }

    function createParticles(x, y, color, count) {
        for (let i = 0; i < count; i++) {
            particles.push({
                x, y,
                vx: (Math.random() - 0.5) * 12,
                vy: (Math.random() - 0.5) * 12,
                life: 1.0,
                color
            });
        }
    }

    function shakeScreen() {
        canvas.style.transform = `translate(${(Math.random()-0.5)*15}px, ${(Math.random()-0.5)*15}px)`;
        setTimeout(() => canvas.style.transform = '', 50);
    }

    function updateUI() {
        scoreElement.innerText = score;
        healthElement.innerText = 'ðŸ¦·'.repeat(Math.max(0, health));
        targetElement.innerText = MONTHS[currentMonthIndex];
    }

    function startGame() {
        score = 0;
        health = 3;
        currentMonthIndex = 0;
        items = Array.from({ length: 6 }, () => new MonthItem());
        particles = [];
        gameActive = true;
        overlay.style.display = 'none';
        updateUI();
        requestAnimationFrame(gameLoop);
    }

    function endGame() {
        gameActive = false;
        overlay.innerHTML = `
            <h1 class="text-6xl font-black text-blue-600 mb-4">YEAR'S END!</h1>
            <p class="text-2xl text-gray-700">You mastered ${score/50} months!</p>
            <p class="text-4xl font-bold mt-4 text-blue-500">Score: ${score}</p>
            <button class="btn" onclick="startGame()">PLAY AGAIN</button>
        `;
        overlay.style.display = 'flex';
    }

    function drawMouth() {
        mouth.x += (mouth.targetX - mouth.x) * 0.15;
        mouth.y += (mouth.targetY - mouth.y) * 0.15;

        let closestDist = 400;
        items.forEach(item => {
            const d = Math.sqrt((item.x - mouth.x)**2 + (item.y - mouth.y)**2);
            if (d < closestDist) closestDist = d;
        });
        
        const targetOpen = closestDist < 150 ? 1 : 0.2;
        mouth.open += (targetOpen - mouth.open) * 0.2;

        const s = mouth.size;
        ctx.save();
        ctx.translate(mouth.x, mouth.y);

        // Lips
        ctx.fillStyle = '#3b82f6'; // Blue lips for Calendar Chomp
        ctx.beginPath();
        ctx.ellipse(0, -s * 0.2 * mouth.open, s, s * 0.6, 0, Math.PI, 0);
        ctx.fill();
        ctx.beginPath();
        ctx.ellipse(0, s * 0.2 * mouth.open, s, s * 0.6, 0, 0, Math.PI);
        ctx.fill();

        // Inner
        ctx.fillStyle = '#1e3a8a';
        ctx.beginPath();
        ctx.ellipse(0, 0, s * 0.85, s * 0.4 * mouth.open, 0, 0, Math.PI * 2);
        ctx.fill();

        // Teeth
        ctx.fillStyle = 'white';
        const tCount = 6;
        const tW = (s * 1.2) / tCount;
        for(let i=0; i < tCount; i++) {
            const tx = -s * 0.6 + (i * tW) + tW/2;
            ctx.fillRect(tx - tW/3, -s * 0.1 * mouth.open, tW/1.5, s * 0.15 * mouth.open);
        }

        ctx.restore();
    }

    function gameLoop() {
        if (!gameActive) return;
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        items.forEach(item => {
            item.update();
            item.draw();
        });

        for (let i = particles.length - 1; i >= 0; i--) {
            const p = particles[i];
            p.x += p.vx; p.y += p.vy; p.life -= 0.02;
            ctx.globalAlpha = p.life;
            ctx.fillStyle = p.color;
            ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI * 2); ctx.fill();
            if (p.life <= 0) particles.splice(i, 1);
        }
        ctx.globalAlpha = 1;

        drawMouth();
        requestAnimationFrame(gameLoop);
    }
</script>
</body>
</html>